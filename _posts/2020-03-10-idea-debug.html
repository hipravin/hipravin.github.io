---
layout: post
title: Способы отладки в IDEA
excerpt: Условные брейкпоинты, исключения, удалённая отладка.
---
<p>Часто начинающие разработчики при исправлени багов ограничиваются одним или несколькими приёмами:</p>

<dl class="dl-horizontal">
    <dt>Созерцание кода</dt>
    <dd>Где-то тут в коде ошибка, сейчас найдём, надо только внимательнее вчитаться.</dd>
    <dt>Отладочная печать</dt>
    <dd>Расставляем строки наподобие "001", "aaaaa", "WTFFF" и т.д. в случайные места программы и запускаем.</dd>
    <dt>Только стандартныe точки останова (брейкпоинты для краткости)</dt>
    <dd>Запускаем отладку и поехали: F7, F7, F8, так... ещё разок, мимо - вот незадача! Назад не вернуться, всё заново.</dd>
</dl>

<p>Ниже опишу приёмы, которые считаю более эффективными, и в большинстве случаев приводящими к результату в случае, если ошибку удаётся воспроизвести.</p>

<dl class="dl-horizontal">
    <dt>Условные брейкпоинты</dt>
    <dd>Программа прерывается только если в момент выполнения условие выполняется, например, user.name.toUpperCase().contains("PRAVIN").
        Условие указывается в IDEA нажатием правой кнопки мыши (ПКМ) на брейпоинте.</dd>
    <dt>Брейкпоинты на исключения</dt>
    <dd>Программа прерывается в тот момент, когда выбрасывается исключение. Часто намного удобнее, чем отлавливать его уже в конструкции catch.
        Устанавливается так: ПКМ на брейкпоинте -> More / Ctrl+Shift+F8 -> + -> Java Exception Breakpoints -> Указываем имя класса исключения (например, JsonProcessingException).
        Иногда можно просто отметить "Any Exception", но тогда в сложных приложениях без остановки из разных библиотек как из ведра сыпятся ClassNotFoundException, NullPointerException
     и ещё прорва всего, к делу не относящегося.</dd>
    <dt>Удалённая отладка (JPDA)</dt>
    <dd>Когда приложение запускается не из IDE (например, другая машина, либо отдельный веб сервер на локальной машине),
        то к нему можно подключиться c помощью технологии JPDA (Java Platform Debugger Architecture). Для этого к параметрам java машины сервера нужно добавить, например,
        -agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=*:5005.
        После чего в Run/Debug Configurations добавить конфигурацию Remote c тем же портом и IP сервера, если это не localhost.
        Нажимаем Debug и дальнейший процесс не отличается от стандартной отладки прямо из IDEA. Если нужно перехватить что-то в первые секунды работы приложения,
        то в параметрах меняем на suspend=y, и тогда сервер будет ожидать подключения отладчика.
        Следует отметить, что если полдключиться удалённо к серверу, которым кто-то пользуется, то сервер буквально остановится: даже без точек останова производительность падает в разы,
        а в противном случае все перехваченные запросы будут ожидать нажатия F9 (продолжить до следующей точки останова) в отладчике.
    </dd>
</dl>

<p>
    Далее разберу всё то же подробнее на примерах и со скриншотами.
</p>